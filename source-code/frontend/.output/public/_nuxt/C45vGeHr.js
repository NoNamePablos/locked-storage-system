import{_ as I}from"./gDly06h5.js";import{_ as M,p as g,a as P,b as q}from"./7-JcZz81.js";import{q as z,r as l,z as A,A as D,o as f,c as F,a as K,b as n,w as m,B as c,F as Y,C as j,d as G,x as w,D as H}from"./72Tm0drb.js";import{_ as J}from"./DD_U3oK2.js";import{u as Q,S as U,_ as W,a as X}from"./CxrCKDH3.js";import{P as Z,S as ee}from"./CfYHM0-g.js";import{B as te}from"./BWi5ilZV.js";import{_ as oe,L as ae}from"./CLlITAd1.js";import"./BAlvlKMe.js";import"./_vq8pnsq.js";import"./W1NEtkwR.js";import"./5CQO_EzI.js";import"./CQJCkcqG.js";import"./BMA6RC22.js";import"./DxrL16iQ.js";import"./NYUDkq8_.js";import"./bHe5Oq27.js";import"./DGYNie3Z.js";import"./CLfbelQC.js";const se={class:"h-full"},Be=z({__name:"[id]",setup(ne){const{typeOfView:h,changeTypeOfView:B}=Q(U.RECORDS_TYPE),s=l(),a=l(!1),r=l(!1),d=l(!1),_=l(),p=A();console.log(p);const v=async()=>{a.value=!0;try{const t={cluster_id:p.params.id},e=await g.list(t);s.value=e.data,console.log(s.value)}catch(t){console.log(t)}finally{a.value=!1}},C=async t=>{a.value=!0;try{const e=await g.findById({record_id:t});console.log(e),_.value=e}catch(e){console.log(e)}finally{a.value=!1}};D(async()=>{await v()});const i=l(!1),R=()=>{i.value=!1,d.value=!1,r.value=!1,_.value=null},$=()=>{i.value=!0},V=async(t=null)=>{a.value=!0;try{await v(),R()}catch(e){console.log(e)}finally{a.value=!1}},k=async(t=0,e="create")=>{if(e==="create"&&(i.value=!0),e==="edit"){r.value=!0,d.value=!0;try{await C(t),i.value=!0}catch(u){console.log(u)}finally{r.value=!1}}if(e==="open"){r.value=!0,d.value=!0;try{await C(t),i.value=!0}catch(u){console.log(u)}finally{r.value=!1}}},x=l(""),E=async t=>{a.value=!0;try{if(!t.length)await v();else{const e=await g.search({find:t,cluster_id:+p.params.id});s.value=e}}catch(e){console.log(e)}finally{a.value=!1}};return(t,e)=>{const u=te,O=I,S=ee,b=q,L=ae,N=oe,T=P;return f(),F(Y,null,[K("div",se,[n(M,{class:"mt-4",name:"Все хранилища",route:"/platform/records"}),n(O,{title:"Записи хранилища"},{right:m(()=>[n(u,{type:"primary",size:"middle",icon:("h"in t?t.h:c(j))(c(Z)),onClick:e[0]||(e[0]=o=>$())},{default:m(()=>[G("Добавить пароль")]),_:1},8,["icon"])]),_:1}),n(N,{class:"bg-white h-full"},{default:m(()=>[n(W,{search:x.value,"type-view":c(h),onChangeView:e[1]||(e[1]=o=>c(B)(o)),onSearch:e[2]||(e[2]=o=>E(o))},null,8,["search","type-view"]),n(L,{class:"mt-6 px-4"},{default:m(()=>[s.value&&s.value.length===0?(f(),w(J,{key:0,title:"Сейчас нет записей"})):H("",!0),a.value?(f(),w(S,{key:1})):(f(),w(X,{key:2,items:s.value,"type-view":c(h),"button-text":"Добавить пароль",empty:s.value&&s.value.length===0,onAdd:e[5]||(e[5]=o=>$())},{card:m(({item:o})=>[n(b,{item:o,onOpen:e[3]||(e[3]=y=>k(y,"open")),onEdit:e[4]||(e[4]=y=>k(y,"edit"))},null,8,["item"])]),_:1},8,["items","type-view","empty"]))]),_:1})]),_:1})]),n(T,{"is-editing":d.value,"is-loading":r.value,item:_.value,open:i.value,"clusterd-id":c(p).params.id,onClose:e[6]||(e[6]=o=>R()),onConfirm:e[7]||(e[7]=o=>V(o))},null,8,["is-editing","is-loading","item","open","clusterd-id"])],64)}}});export{Be as default};
