import{E as _e,J as ve,q as T,_ as k,r as P,aG as ge,aH as ye,O as he,M as X,aI as Ce,aJ as be,aa as we,b as d,Q as U,aK as xe,a1 as B,Z as ke,a2 as Y,ax as Pe,W as $,V as te,o as S,x as N,w as C,d as V,B as E,a as M,am as $e,an as Se,aD as oe,s as Be,v as ne,a5 as ae,aE as se,Y as Te,aL as Ie,aM as Oe,c as le,D as Z,F as re,aN as je}from"./72Tm0drb.js";import{a as Ee,_ as ie,F as ce}from"./CQJCkcqG.js";import{t as Ne,b as Fe,e as Ae,f as ee,B as q}from"./BWi5ilZV.js";import{A as Me,M as De}from"./bHe5Oq27.js";import{_ as ze}from"./BlYSN2JU.js";import{i as Re}from"./DxrL16iQ.js";import{u as Ue}from"./DbFrzxmd.js";import{K as Ve}from"./BMA6RC22.js";import{o as Ke}from"./_vq8pnsq.js";import{_ as qe,S as Je}from"./B26nMvX6.js";import{_ as Le}from"./BAlvlKMe.js";const We=e=>{const{componentCls:t,iconCls:o,zIndexPopup:n,colorText:u,colorWarning:_,marginXS:r,fontSize:a,fontWeightStrong:m,lineHeight:c}=e;return{[t]:{zIndex:n,[`${t}-inner-content`]:{color:u},[`${t}-message`]:{position:"relative",marginBottom:r,color:u,fontSize:a,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${t}-message-icon ${o}`]:{color:_,fontSize:a,flex:"none",lineHeight:1,paddingTop:(Math.round(a*c)-a)/2},"&-title":{flex:"auto",marginInlineStart:r},"&-title-only":{fontWeight:m}},[`${t}-description`]:{position:"relative",marginInlineStart:a+r,marginBottom:r,color:u,fontSize:a},[`${t}-buttons`]:{textAlign:"end",button:{marginInlineStart:r}}}}},He=_e("Popconfirm",e=>We(e),e=>{const{zIndexPopupBase:t}=e;return{zIndexPopup:t+60}});var Ge=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,n=Object.getOwnPropertySymbols(e);u<n.length;u++)t.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(e,n[u])&&(o[n[u]]=e[n[u]]);return o};const Qe=()=>k(k({},Ae()),{prefixCls:String,content:B(),title:B(),description:B(),okType:ke("primary"),disabled:{type:Boolean,default:!1},okText:B(),cancelText:B(),icon:B(),okButtonProps:Y(),cancelButtonProps:Y(),showCancel:{type:Boolean,default:!0},onConfirm:Function,onCancel:Function}),Xe=T({compatConfig:{MODE:3},name:"APopconfirm",inheritAttrs:!1,props:Re(Qe(),k(k({},Ne()),{trigger:"click",placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1,arrowPointAtCenter:!1,autoAdjustOverflow:!0,okType:"primary",disabled:!1})),slots:Object,setup(e,t){let{slots:o,emit:n,expose:u,attrs:_}=t;const r=P();ge(e.visible===void 0),u({getPopupDomNode:()=>{var i,p;return(p=(i=r.value)===null||i===void 0?void 0:i.getPopupDomNode)===null||p===void 0?void 0:p.call(i)}});const[a,m]=Ue(!1,{value:ye(e,"open")}),c=(i,p)=>{e.open===void 0&&m(i),n("update:open",i),n("openChange",i,p)},s=i=>{c(!1,i)},h=i=>{var p;return(p=e.onConfirm)===null||p===void 0?void 0:p.call(e,i)},f=i=>{var p;c(!1,i),(p=e.onCancel)===null||p===void 0||p.call(e,i)},l=i=>{i.keyCode===Ve.ESC&&a&&c(!1,i)},y=i=>{const{disabled:p}=e;p||c(i)},{prefixCls:v,getPrefixCls:b}=he("popconfirm",e),g=X(()=>b()),x=X(()=>b("btn")),[w]=He(v),[F]=Ce("Popconfirm",be.Popconfirm),J=()=>{var i,p,I,O,j;const{okButtonProps:A,cancelButtonProps:D,title:z=(i=o.title)===null||i===void 0?void 0:i.call(o),description:R=(p=o.description)===null||p===void 0?void 0:p.call(o),cancelText:de=(I=o.cancel)===null||I===void 0?void 0:I.call(o),okText:pe=(O=o.okText)===null||O===void 0?void 0:O.call(o),okType:L,icon:W=((j=o.icon)===null||j===void 0?void 0:j.call(o))||d(Pe,null,null),showCancel:me=!0}=e,{cancelButton:H,okButton:G}=o,Q=k({onClick:f,size:"small"},D),fe=k(k(k({onClick:h},ee(L)),{size:"small"}),A);return d("div",{class:`${v.value}-inner-content`},[d("div",{class:`${v.value}-message`},[W&&d("span",{class:`${v.value}-message-icon`},[W]),d("div",{class:[`${v.value}-message-title`,{[`${v.value}-message-title-only`]:!!R}]},[z])]),R&&d("div",{class:`${v.value}-description`},[R]),d("div",{class:`${v.value}-buttons`},[me?H?H(Q):d(q,Q,{default:()=>[de||F.value.cancelText]}):null,G?G(fe):d(Me,{buttonProps:k(k({size:"small"},ee(L)),A),actionFn:h,close:s,prefixCls:x.value,quitOnNullishReturnValue:!0,emitEvent:!0},{default:()=>[pe||F.value.okText]})])])};return()=>{var i;const{placement:p,overlayClassName:I,trigger:O="click"}=e,j=Ge(e,["placement","overlayClassName","trigger"]),A=Ke(j,["title","content","cancelText","okText","onUpdate:open","onConfirm","onCancel","prefixCls"]),D=we(v.value,I);return w(d(ze,U(U(U({},A),_),{},{trigger:O,placement:p,onOpenChange:y,open:a.value,overlayClassName:D,transitionName:xe(g.value,"zoom-big",e.transitionName),ref:r,"data-popover-inject":!0}),{default:()=>[Fe(((i=o.default)===null||i===void 0?void 0:i.call(o))||[],{onKeydown:z=>{l(z)}},!1)],content:J}))}}}),Ye=ve(Xe),Ze={list:async e=>{const{$http:t}=$();return(await t.get("/api/clusters",e)).data.data},create:async e=>{const{$http:t}=$();return(await t.post("/api/clusters/store",e)).data.data},update:async e=>{const{$http:t}=$();return(await t.post("/api/clusters/update",e)).data.data},delete:async e=>{const{$http:t}=$();return(await t.post(`/api/clusters/delete/${e}`)).data.data},findById:async e=>{const{$http:t}=$();return(await t.get("/api/clusters/show",{params:{password:e.password,user_id:e.user_id,cluster_id:e.cluster_id}})).data.data},search:async e=>{const{$http:t}=$();return(await t.post("/api/clusters/search",e)).data.data},searchCompany:async e=>{const{$http:t}=$();return(await t.post("/api/clusters/search-company",e)).data.data}},et={class:"py-4"},ue=T({__name:"BaseModal",props:{open:{type:Boolean,default:!1},fullModal:{type:Boolean},modalTitle:{default:""},loading:{type:Boolean,default:!1}},emits:["close","submit"],setup(e,{emit:t}){const o=e,{open:n,fullModal:u,loading:_}=te(o),r=t,a=()=>{r("submit")},m=()=>{r("close")};return(c,s)=>{const h=q,f=De;return S(),N(f,{open:E(n),"onUpdate:open":s[0]||(s[0]=l=>Se(n)?n.value=l:null),title:c.modalTitle,width:"100%","wrap-class-name":E(u)?"full-modal":"",onCancel:s[1]||(s[1]=l=>m()),onOk:a},{footer:C(()=>[d(h,{key:"back",onClick:m},{default:C(()=>[V("Отмена")]),_:1}),d(h,{key:"submit",type:"primary",loading:E(_),onClick:a},{default:C(()=>[V("Подтвердить")]),_:1},8,["loading"])]),default:C(()=>[M("div",et,[$e(c.$slots,"default")])]),_:3},8,["open","title","wrap-class-name"])}}}),yt=T({__name:"AuthCluster",props:{type:{},clusterId:{},loading:{type:Boolean}},emits:["submit"],setup(e,{emit:t}){const o=oe(),n=e,u=Be(),{clusterId:_,type:r}=te(n),a=P(!1),m=async()=>{a.value=!0;try{const l=await Ze.findById({user_id:u.getUser.id,password:s.password,cluster_id:_.value});h("submit",{data:l,type:r.value})}catch(l){console.log(l),Te.error("Доступ запрещен")}finally{a.value=!1}},c=P(null),s=ne({password:""}),h=t,f=async()=>{try{(await c.value.validateFields()).errorFields||await m()}catch(l){console.log(l)}};return ae(()=>{var l;o.open||(l=c.value)==null||l.resetFields()}),(l,y)=>{const v=Ee,b=ie,g=ce;return S(),N(ue,se(E(o),{onSubmit:y[1]||(y[1]=x=>f())}),{default:C(()=>[d(g,{ref_key:"modalAuth",ref:c,layout:"vertical",model:s,name:"basic",autocomplete:"off"},{default:C(()=>[d(b,{name:"password",rules:[{required:!0,message:"Пожалуйста введите пароль от хранилища"}]},{default:C(()=>[d(v,{value:s.password,"onUpdate:value":y[0]||(y[0]=x=>s.password=x)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},16)}}});var K={exports:{}};(function(e,t){(function(o,n){n(t,e)})(Ie,function(o,n){var u={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function _(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function r(c){try{delete window[c]}catch{window[c]=void 0}}function a(c){var s=document.getElementById(c);s&&document.getElementsByTagName("head")[0].removeChild(s)}function m(c){var s=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],h=c,f=s.timeout||u.timeout,l=s.jsonpCallback||u.jsonpCallback,y=void 0;return new Promise(function(v,b){var g=s.jsonpCallbackFunction||_(),x=l+"_"+g;window[g]=function(F){v({ok:!0,json:function(){return Promise.resolve(F)}}),y&&clearTimeout(y),a(x),r(g)},h+=h.indexOf("?")===-1?"?":"&";var w=document.createElement("script");w.setAttribute("src",""+h+l+"="+g),s.charset&&w.setAttribute("charset",s.charset),s.nonce&&w.setAttribute("nonce",s.nonce),s.referrerPolicy&&w.setAttribute("referrerPolicy",s.referrerPolicy),s.crossorigin&&w.setAttribute("crossorigin","true"),w.id=x,document.getElementsByTagName("head")[0].appendChild(w),y=setTimeout(function(){b(new Error("JSONP request to "+c+" timed out")),r(g),a(x),window[g]=function(){r(g)}},f),w.onerror=function(){b(new Error("JSONP request to "+c+" failed")),r(g),a(x),y&&clearTimeout(y)}})}n.exports=m})})(K,K.exports);var tt=K.exports;const ot=Oe(tt),nt=M("a",null,"Delete",-1),at=T({__name:"UsersTable",props:{data:{}},setup(e){const t=[{title:"id",dataIndex:"id",width:"10%"},{title:"name",dataIndex:"name"},{title:"email",dataIndex:"email"},{title:"role",dataIndex:"role"},{title:"operation",dataIndex:"operation"}],o=n=>{console.log("delete item from users table: ",n)};return(n,u)=>{const _=Ye,r=qe;return S(),N(r,{bordered:"","data-source":n.data,columns:t},{bodyCell:C(({column:a,record:m})=>[a.dataIndex==="operation"?(S(),le(re,{key:0},[n.data.length?(S(),N(_,{key:0,title:"Удалить?",onConfirm:c=>o(m.id)},{default:C(()=>[nt]),_:2},1032,["onConfirm"])):Z("",!0)],64)):Z("",!0)]),_:1},8,["data-source"])}}}),st={class:"mt-4"},lt=T({__name:"AddingUsersCluster",setup(e){let t,o="";const n=P(!1);function u(f,l){t&&(clearTimeout(t),t=null),o=f;function y(){const v=je.stringify({code:"utf-8",q:f});ot(`https://suggest.taobao.com/sug?${v}`).then(b=>b.json()).then(b=>{if(o===f){const g=b.result,x=[];g.forEach(w=>{x.push({value:w[0],label:w[0]})}),l(x)}})}t=setTimeout(y,300)}const _=P([]),r=P(),a=P([]),m=f=>{n.value=!0,u(f,l=>_.value=l),n.value=!1},c=f=>{console.log(f),r.value=f,u(f,l=>_.value=l)},s=()=>{r.value!=""&&a.value.push(r.value)},h=P([{id:1,name:"Edward King",email:"edward32@mail.ru",role:"owner"},{id:2,name:"Edward King 2",email:"edward32@mail.ru",role:"manager"},{id:3,name:"Edward King 3",email:"edward32@mail.ru",role:"manager"}]);return(f,l)=>{const y=Je,v=q,b=Le;return S(),le(re,null,[d(b,{gap:"middle"},{default:C(()=>[d(y,{value:r.value,"onUpdate:value":l[0]||(l[0]=g=>r.value=g),"show-search":"",placeholder:"input search text","default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":null,options:_.value,onSearch:m,onChange:c},null,8,["value","options"]),M("div",null,[d(v,{type:"primary",onClick:l[1]||(l[1]=g=>s())},{default:C(()=>[V("Добавить")]),_:1})])]),_:1}),M("div",st,[d(at,{data:h.value},null,8,["data"])])],64)}}}),ht=T({__name:"UsersModalCluster",emits:["submit"],setup(e,{emit:t}){const o=oe(),n=P(null),u=ne({users:[]}),_=t,r=async()=>{var a;try{(await((a=n.value)==null?void 0:a.validateFields())).errorFields||_("submit")}catch(m){console.log(m)}};return ae(()=>{var a;o.open||(a=n.value)==null||a.resetFields()}),(a,m)=>{const c=ie,s=ce;return S(),N(ue,se(E(o),{onSubmit:m[0]||(m[0]=h=>r())}),{default:C(()=>[d(s,{ref_key:"userModalCluser",ref:n,layout:"vertical",model:u,name:"basic",autocomplete:"off"},{default:C(()=>[d(c,{label:"Пользователи",name:"users"},{default:C(()=>[d(lt)]),_:1})]),_:1},8,["model"])]),_:1},16)}}});export{ht as _,yt as a,ue as b,Ze as c};
