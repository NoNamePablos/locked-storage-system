import{_ as te}from"./DdJQVxg6.js";import{q as A,a7 as G,o as u,c as U,a as R,$ as n,t as P,b as e,a8 as oe,a9 as M,r as w,v as se,h as K,x as v,w as t,d as B,a1 as Z,a3 as Y,aa as ae,ab as ne,ac as le,F as re,a5 as ie}from"./DutA6s4s.js";import{S as ce,u as de,a as pe,_ as ue,b as me}from"./59bztQ-X.js";import{c as H,H as fe,L as _e,_ as ve,S as ye}from"./GqXCqae9.js";import{u as ge}from"./BtrZ7jwe.js";import{S as J,a as ke,b as we,P as xe}from"./BFGb0XXS.js";import{B as Q,_ as he}from"./o1aMqsoj.js";import{I as Ce,_ as $e,a as be,F as Re}from"./DQy1XneP.js";import{M as Ie}from"./fAwOVESI.js";import{_ as Le}from"./BsPBNx6V.js";import{_ as Be}from"./BzkKGvdw.js";import{_ as Se,L as Ee}from"./Tss58tcD.js";import"./DqJXAqIy.js";import"./D-QVxuq2.js";import"./BKdPbglU.js";import"./DGYNie3Z.js";import"./BEw11EN_.js";/**
 * @license lucide-vue-next v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=H("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=H("GlobeIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-vue-next v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=H("InfoIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.376.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=H("UserIcon",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ue={class:"relative p-4 rounded border border-solid border-gray-400 flex items-center gap-4 hover:shadow transition-all cursor-pointer"},qe=["src"],Te={class:"flex flex-col gap-2"},je={class:"font-bold text-md"},Ne={class:"text-gray-400 font-medium"},Pe=A({__name:"RecordsCard",props:{item:{}},emits:["edit","open"],setup(d,{emit:r}){const c=d,{item:p}=G(c),f=i=>`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://${i.trim()}&size=64`,x=r;return(i,h)=>{var y,I,L;return u(),U("div",Ue,[R("div",null,[R("img",{src:f(n(p).site),class:"w-[64px] h-[64px] object-contain"},null,8,qe)]),R("div",Te,[R("div",je,P(((y=n(p))==null?void 0:y.title)??n(p).site),1),R("div",Ne,P(((I=n(p))==null?void 0:I.email)??((L=n(p))==null?void 0:L.login)??""),1)]),R("div",{class:"absolute top-4 right-2 text-gray-400 transition-all hover:text-blue-400",onClick:h[0]||(h[0]=oe(C=>x("edit",n(p).id),["stop"]))},[e(n(ce),{color:"currentColor"})])])}}}),z={list:async d=>{const{$http:r}=M();return(await r.get("/api/records",{params:{cluster_id:d.cluster_id}})).data.data},create:async d=>{const{$http:r}=M();return(await r.post("/api/records/store",d)).data.data},update:async d=>{const{$http:r}=M();return(await r.post("/api/records/update",d)).data.data},delete:async d=>{const{$http:r}=M();return(await r.post(`/api/records/delete/${d}`)).data.data},findById:async d=>{const{$http:r}=M();return(await r.get("/api/records/show",{params:{record_id:d.record_id}})).data.data},search:async d=>{const{$http:r}=M();return(await r.post("/api/records/search",d)).data.data}},Ae={key:1},He=R("span",{class:"text-center block"},"Вводите полный адрес vk.com",-1),De={key:0},Ge=A({__name:"RecordsModal",props:{open:{type:Boolean},isEditing:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},item:{default:()=>({})},clusterdId:{}},emits:["close","confirm"],setup(d,{emit:r}){const c=w(!1),p=d,{copy:f}=ge(),{open:x,isEditing:i,isLoading:h,item:y,clusterdId:I}=G(p),L=r,C=async()=>{var o;c.value=!0;try{const s=await((o=E.value)==null?void 0:o.validateFields());if(s&&!s.errorFields){const b={password:l.password,site:l.site,login:l.login,title:l.title,...!i.value&&{cluster_id:+I.value},...i.value&&{record_id:y.value.id}};console.log(b);const k=await(i.value?z.update:z.create)(b);L("confirm",k)}}catch(s){console.log(s)}finally{c.value=!0}},q=()=>{L("close")},E=w(null),T=w(null),l=se({title:"",site:"",login:"",password:""});K(()=>y.value,o=>{console.log("mew : ",o),console.log(i.value),i.value&&o&&(console.log("news: ",o),l.title=(o==null?void 0:o.title)??"",l.site=(o==null?void 0:o.site)??"",l.login=(o==null?void 0:o.login)??"",l.password=(o==null?void 0:o.password)??"",console.log(l))},{immediate:!0});const S=w(!1),D=()=>{S.value=!S.value};K(()=>x.value,o=>{var s,b;o&&!i.value&&(console.log(o),console.log("item:",l),l.title="",l.site="",l.login="",l.password=""),o||(console.log("res: ",o),(s=E.value)==null||s.resetFields(),S.value&&((b=T.value)==null||b.resetForm(),S.value=!1))},{immediate:!0});const m=o=>{try{f(o),Y.success("Данные скопированы")}catch{Y.error("Ошибка копирования")}},a=async()=>{var o;c.value=!0;try{const s=await z.delete((o=y.value)==null?void 0:o.id);L("confirm",s)}catch(s){console.log(s)}finally{c.value=!1}};return(o,s)=>{const b=J,$=Q,k=Le,F=ke,j=we,g=ye,O=Ce,N=$e,W=he,X=be,V=Re,ee=Ie;return u(),v(ee,{open:n(x),onCancel:q,onOk:C},{title:t(()=>{var _;return[n(h)?(u(),v(b,{key:0,paragraph:{rows:0},active:""})):(u(),U("div",Ae,P(n(i)?(_=n(y))==null?void 0:_.title:"Добавление пароля"),1))]}),footer:t(()=>[n(i)?(u(),v(k,{key:0,justify:"space-between",wrap:"wrap"},{default:t(()=>[e($,{type:"link",danger:"",loading:c.value,onClick:s[0]||(s[0]=_=>a())},{default:t(()=>[B("Удалить пароль")]),_:1},8,["loading"]),e($,{type:"primary",loading:c.value,onClick:s[1]||(s[1]=_=>C())},{default:t(()=>[B("Сохранить")]),_:1},8,["loading"])]),_:1})):(u(),v($,{key:"submit",type:"primary",loading:c.value,onClick:C},{default:t(()=>[B("Добавить пароль")]),_:1},8,["loading"]))]),default:t(()=>[n(h)?(u(),v(g,{key:0,class:"w-[250px]",direction:"vertical"},{default:t(()=>[e(k,{justify:"space-between",wrap:"wrap"},{default:t(()=>[e(F,{active:""})]),_:1}),e(k,{justify:"space-between",wrap:"wrap"},{default:t(()=>[e(F,{active:""}),e(j,{active:""})]),_:1}),e(k,{justify:"space-between",wrap:"wrap"},{default:t(()=>[e(F,{class:"flex-grow",active:""})]),_:1}),e(k,{justify:"space-between",wrap:"wrap"},{default:t(()=>[e(F,{class:"flex-grow",active:""}),e(j,{active:""})]),_:1})]),_:1})):(u(),v(V,{key:1,ref_key:"modal",ref:E,layout:"vertical",model:l,name:"basic",autocomplete:"off"},{default:t(()=>[e(N,{name:"title",class:"w-[340px]",rules:[{required:!0,message:"Введите название сайта/сервиса"}]},{default:t(()=>[e(O,{value:l.title,"onUpdate:value":s[2]||(s[2]=_=>l.title=_),class:"text-gray-400",placeholder:"Название сайта/сервиса"},{prefix:t(()=>[e(n(fe),{size:20,color:"currentColor"})]),_:1},8,["value"])]),_:1}),e(k,{wrap:"wrap",gap:4},{default:t(()=>[e(N,{class:"w-[340px]",name:"site",rules:[{required:!0,message:"Введите URL"}]},{default:t(()=>[e(O,{value:l.site,"onUpdate:value":s[3]||(s[3]=_=>l.site=_),class:"text-gray-400",placeholder:"URL"},{prefix:t(()=>[e(n(Me),{size:20,color:"currentColor"})]),suffix:t(()=>[e(W,null,{title:t(()=>[He]),default:t(()=>[e(n(ze),{size:20,color:"currentColor"})]),_:1})]),_:1},8,["value"])]),_:1}),n(i)?(u(),v($,{key:1,type:"primary",class:"flex-grow",ghost:"",onClick:s[4]||(s[4]=_=>m(l.site))},{default:t(()=>[B("Скопировать")]),_:1})):(u(),v($,{key:0,type:"primary",class:"flex-grow",ghost:""},{default:t(()=>[B("Вставить")]),_:1}))]),_:1}),e(N,{class:"w-[340px]",name:"login",rules:[{required:!0,message:"Введите логин/Email"}]},{default:t(()=>[e(O,{value:l.login,"onUpdate:value":s[5]||(s[5]=_=>l.login=_),class:"text-gray-400",placeholder:"Введите логин/Email"},{prefix:t(()=>[e(n(Oe),{size:20,color:"currentColor"})]),_:1},8,["value"])]),_:1}),e(k,{wrap:"wrap",gap:4},{default:t(()=>[e(N,{class:"w-[340px]",name:"password",rules:[{required:!0,message:"Введите пароль"}]},{default:t(()=>[e(X,{value:l.password,"onUpdate:value":s[6]||(s[6]=_=>l.password=_),class:"text-gray-400",placeholder:"Введите пароль"},{prefix:t(()=>[e(n(_e),{size:20,color:"currentColor"})]),_:1},8,["value"])]),_:1}),n(i)?(u(),v($,{key:1,type:"primary",class:"flex-grow",ghost:"",onClick:s[8]||(s[8]=_=>m(l.password))},{default:t(()=>[B("Скопировать")]),_:1})):(u(),v($,{key:0,type:"primary",class:"flex-grow",ghost:"",onClick:s[7]||(s[7]=_=>D())},{default:t(()=>[B("Проверить")]),_:1}))]),_:1}),S.value?(u(),U("div",De,[e(ve,{ref_key:"leaksFormRef",ref:T},null,512)])):Z("",!0)]),_:1},8,["model"]))]),_:1},8,["open"])}}}),Ke={class:"text-lg leading-4 font-medium"},Ye=A({__name:"BackButton",props:{name:{default:""},route:{default:""}},setup(d){const r=d,{name:c,route:p}=G(r),f=()=>{p.value&&ae(p.value)};return(x,i)=>(u(),U("div",{class:"text-gray-400 inline-flex items-center cursor-pointer",onClick:i[0]||(i[0]=h=>f())},[e(n(Fe),{size:24,color:"currentColor"}),R("span",Ke,P(n(c)),1)]))}}),Ze={class:"h-full"},ut=A({__name:"[id]",setup(d){const{typeOfView:r,changeTypeOfView:c}=de(pe.RECORDS_TYPE),p=w(),f=w(!1),x=w(!1),i=w(!1),h=w(),y=ne();console.log(y);const I=async()=>{f.value=!0;try{const m={cluster_id:y.params.id},a=await z.list(m);p.value=a,console.log(p.value)}catch(m){console.log(m)}finally{f.value=!1}},L=async m=>{f.value=!0;try{const a=await z.findById({record_id:m});console.log(a),h.value=a}catch(a){console.log(a)}finally{f.value=!1}};le(async()=>{await I()});const C=w(!1),q=()=>{C.value=!1,i.value=!1,x.value=!1,h.value=null},E=()=>{C.value=!0},T=async(m=null)=>{f.value=!0;try{await I(),q()}catch(a){console.log(a)}finally{f.value=!1}},l=async(m=0,a="create")=>{if(a==="create"&&(C.value=!0),a==="edit"){x.value=!0,i.value=!0;try{await L(m),C.value=!0}catch(o){console.log(o)}finally{x.value=!1}}},S=w(""),D=async m=>{f.value=!0;try{if(!m.length)await I();else{const a=await z.search({find:m,cluster_id:+y.params.id});p.value=a}}catch(a){console.log(a)}finally{f.value=!1}};return(m,a)=>{const o=Q,s=te,b=J,$=Pe,k=Ee,F=Se,j=Ge;return u(),U(re,null,[R("div",Ze,[e(Ye,{class:"mt-4",name:"Кластеры",route:"/platform/records"}),e(s,{title:"Записи кластера"},{right:t(()=>[e(o,{type:"primary",size:"middle",icon:("h"in m?m.h:n(ie))(n(xe)),onClick:a[0]||(a[0]=g=>E())},{default:t(()=>[B("Добавить пароль")]),_:1},8,["icon"])]),_:1}),e(F,{class:"bg-white h-full"},{default:t(()=>[e(ue,{search:S.value,"type-view":n(r),onChangeView:a[1]||(a[1]=g=>n(c)(g)),onSearch:a[2]||(a[2]=g=>D(g))},null,8,["search","type-view"]),e(k,{class:"mt-6 px-4"},{default:t(()=>[p.value&&p.value.length===0?(u(),v(Be,{key:0,title:"Сейчас кластеры пусты","button-title":"Добавить кластер"})):Z("",!0),f.value?(u(),v(b,{key:1})):(u(),v(me,{key:2,items:p.value,"type-view":n(r),"button-text":"Добавить пароль",onAdd:a[4]||(a[4]=g=>E())},{card:t(({item:g})=>[e($,{item:g,onEdit:a[3]||(a[3]=O=>l(O,"edit"))},null,8,["item"])]),_:1},8,["items","type-view"]))]),_:1})]),_:1})]),e(j,{"is-editing":i.value,"is-loading":x.value,item:h.value,open:C.value,"clusterd-id":n(y).params.id,onClose:a[5]||(a[5]=g=>q()),onConfirm:a[6]||(a[6]=g=>T(g))},null,8,["is-editing","is-loading","item","open","clusterd-id"])],64)}}});export{ut as default};
